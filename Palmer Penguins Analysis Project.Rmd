---
title: "Palmer Penguins Analysis Project"
author: "Ahmed Kamel"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: flatly
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

1. Project Introduction üêß
This project explores the Palmer Penguins dataset to analyze the relationship between various physical characteristics of penguin species using R. We will focus on species distribution, sexual dimorphism, and correlation between body measurements.

2. Loading Libraries & Data
First, we load the necessary libraries for visualization and analysis.
```{r}
library(palmerpenguins)
library(ggplot2)
library(RColorBrewer)
library(pheatmap)

# Load and Inspect Data
Data = penguins
Data_clean = na.omit(Data)
head(Data_clean)
```

3. Univariate Analysis

Species Distribution
Which species is the most common across the islands?
```{r}
ggplot(data = Data_clean, mapping = aes(x = species, fill = island)) +
  geom_bar() +
  theme_bw() +
  scale_fill_brewer(palette = "Set1") +
  xlab("Species") +
  ylab("Count") +
  ggtitle("Penguins Species Distribution")
```

Flipper Length Distribution
Analyzing the spread of flipper lengths reveals distinct groups.
```{r}
ggplot(data = Data_clean, mapping = aes(x = flipper_length_mm, fill = species)) +
  geom_histogram(bins = 25, color = "black", alpha = 0.6, position = "identity") +
  theme_bw() +
  scale_fill_brewer(palette = "Set1") +
  xlab("Flipper Length (mm)") +
  ylab("Count") +
  ggtitle("Flipper Length Distribution")
```

4. Bivariate Analysis

Sexual Dimorphism (Body Mass)
Is there a significant difference in mass between male and female penguins?
```{r}
ggplot(data = Data_clean, mapping = aes(x = sex, y = body_mass_g, fill = sex)) +
  geom_boxplot() +
  theme_bw() +
  scale_fill_brewer(palette = "Set2") +
  xlab("Sex") +
  ylab("Body Mass (g)") +
  ggtitle("Body Mass Comparison by Sex")
```

Bill Dimensions (Simpson's Paradox)
Investigating the relationship between bill length and depth.
```{r}
ggplot(data = Data_clean, mapping = aes(x = bill_length_mm, y = bill_depth_mm, colour = species)) +
  geom_point(size = 2, alpha = 0.8) +
  theme_bw() +
  xlab("Bill Length (mm)") +
  ylab("Bill Depth (mm)") +
  ggtitle("Relationship Between Bill Length & Bill Depth") +
  facet_grid(~species)
```

5. Multivariate Analysis (Correlation)
Finally, we look at the correlation between all numeric variables.
```{r}
# Prepare Data
numeric_col = Data_clean[, c("bill_length_mm", "bill_depth_mm", 
                             "flipper_length_mm", "body_mass_g")]
cor_matrix = cor(numeric_col)

# Plot Heatmap
pheatmap(mat = cor_matrix, 
         display_numbers = TRUE, 
         cluster_rows = TRUE, 
         cluster_cols = TRUE, 
         color = colorRampPalette(brewer.pal(n = 7, name = "RdBu"))(100),
         main = "Correlation Heatmap")
```
